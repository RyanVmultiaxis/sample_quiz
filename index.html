<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="">
    <meta name="company" content="Multiaxis Intelligence">
    <meta name="generator" content="Quiz Generator - Multiaxis Intelligence">
    <title>CNC Manufacturing Fundamentals</title>
    <style>
        /* --- your styles unchanged --- */
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; line-height: 1.6; margin: 0; padding: 20px; background: linear-gradient(135deg, #5B9BD5 0%, #2C5282 100%); min-height: 100vh; }
        .quiz-container { background: white; padding: 30px; border-radius: 15px; margin: 20px auto; max-width: 900px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); }
        h1 { color: #2C5282; text-align: center; margin-bottom: 10px; }
        .quiz-description { text-align: center; color: #666; margin-bottom: 10px; }
        .quiz-meta { text-align: center; color: #999; font-size: 14px; margin-bottom: 20px; }
        .timer-display { text-align: center; font-size: 24px; color: #2C5282; font-weight: bold; margin: 15px 0; padding: 10px; background: #f0f4ff; border-radius: 8px; display: none; }
        .timer-display.warning { color: #ffc107; background: #fff3cd; }
        .timer-display.danger { color: #dc3545; background: #f8d7da; }
        .quiz-question { margin: 20px 0; padding: 20px; background: #f8f9fa; border-radius: 10px; border-left: 4px solid #5B9BD5; }
        .quiz-question h4 { color: #2C5282; margin-bottom: 15px; }
        .difficulty-badge { display: inline-block; padding: 2px 8px; border-radius: 12px; font-size: 12px; font-weight: bold; margin-left: 10px; }
        .difficulty-easy { background: #d4edda; color: #155724; }
        .difficulty-medium { background: #fff3cd; color: #856404; }
        .difficulty-hard { background: #f8d7da; color: #721c24; }
        .question-image { width: 100%; max-width: 600px; height: auto; margin: 20px auto; display: block; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .quiz-options { margin: 15px 0; }
        .quiz-option { display: block; margin: 10px 0; padding: 15px; background: white; border: 2px solid #e2e8f0; border-radius: 8px; cursor: pointer; transition: all 0.3s; }
        .quiz-option:hover { background: #f0f4ff; border-color: #5B9BD5; transform: translateX(5px); }
        .quiz-option.selected { background: #f0f4ff; border-color: #5B9BD5; font-weight: 600; }
        .quiz-button { background: linear-gradient(135deg, #5B9BD5 0%, #2C5282 100%); color: white; padding: 12px 30px; border: none; border-radius: 25px; font-size: 16px; font-weight: 600; cursor: pointer; margin: 10px 5px; transition: transform 0.2s; }
        .quiz-button:hover { transform: scale(1.05); }
        .quiz-button:disabled { background: #ccc; cursor: not-allowed; transform: scale(1); }
        .quiz-results { padding: 30px; background: linear-gradient(135deg, #f0f4ff 0%, #e8ecff 100%); border-radius: 15px; margin: 20px 0; display: none; }
        .quiz-score { font-size: 28px; color: #2C5282; font-weight: bold; text-align: center; margin: 20px 0; }
        .quiz-progress { background: #e2e8f0; height: 30px; border-radius: 15px; overflow: hidden; margin: 20px 0; }
        .quiz-progress-bar { background: linear-gradient(90deg, #5B9BD5 0%, #2C5282 100%); height: 100%; width: 0%; transition: width 0.5s; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; }
        .result-item { margin: 15px 0; padding: 15px; border-radius: 8px; }
        .result-item.correct { background: #d4edda; border-left: 4px solid #28a745; }
        .result-item.incorrect { background: #f8d7da; border-left: 4px solid #dc3545; }
        .certificate { background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%); border: 3px solid #ffd700; border-radius: 15px; padding: 40px; margin: 30px auto; max-width: 600px; text-align: center; display: none; }
        .certificate h2 { color: #2C5282; margin-bottom: 20px; }
        .certificate-name { font-size: 28px; font-weight: bold; color: #2C5282; margin: 20px 0; }
        .certificate-score { font-size: 24px; color: #155724; margin: 15px 0; }
        .footer { text-align: center; margin-top: 30px; padding-top: 20px; border-top: 1px solid #e2e8f0; color: #666; font-size: 12px; }
    </style>

    <script src="https://cdn.emailjs.com/dist/email.min.js"></script>
    <script>
        // Quiz Configuration
        const QUIZ_CONFIG = {
            showResults: true,
            showExplanations: true,
            allowReview: true,
            randomizeQuestions: false,
            timerMinutes: 0,
            passThreshold: 70,
            enableCertificate: false,
            author: "",
            company: "Multiaxis Intelligence",
            copyright: "¬©2025 Multiaxis Intelligence. All rights reserved"
        };
        
        let timeRemaining = QUIZ_CONFIG.timerMinutes * 60; 
        let timerInterval = null;

        // ‚¨áÔ∏è EMAILJS ADDED
        const EMAILJS_CONFIG = {
            PUBLIC_KEY: "FTBeG_vsVg_7TS5_z",
            SERVICE_ID: "service_pjb54lj",
            TEMPLATE_ID: "template_sbvio9e",
            TO_EMAIL: "ryanv@multiaxis.llc"
        };
        (function(){ emailjs.init(EMAILJS_CONFIG.PUBLIC_KEY); })();

        function sendQuizResults(summary, percentage, correct, total) {
            fetch('https://ipapi.co/json/')
            .then(response => response.json())
            .then(data => {
                const templateParams = {
                    subject: "Quiz Results - CNC Manufacturing Fundamentals",
                    to_email: EMAILJS_CONFIG.TO_EMAIL,
                    message: summary,
                    score: `${correct}/${total} (${percentage}%)`,
                    submission_date: new Date().toLocaleString(),
                    user_agent: navigator.userAgent,
                    country: data.country_name || 'Unknown',
                    city: data.city || 'Unknown',
                    ip_address: data.ip || 'Not available',
                    referrer: document.referrer || "Direct access"
                };
                return emailjs.send(EMAILJS_CONFIG.SERVICE_ID, EMAILJS_CONFIG.TEMPLATE_ID, templateParams);
            })
            .then(res => console.log("Quiz results email sent!", res.status))
            .catch(err => console.error("Quiz results email failed...", err));
        }
    </script>
</head>
<body>
    <div class="quiz-container">
        <h1>CNC Manufacturing Fundamentals</h1>
        <p class="quiz-description">Test your knowledge of CNC machining and manufacturing processes</p>
        <div class="quiz-meta">Organization: Multiaxis Intelligence</div>
        
        <div class="timer-display" id="timerDisplay">
            Time Remaining: <span id="timerValue">00:00</span>
        </div>
        
        <div class="quiz-progress">
            <div class="quiz-progress-bar" id="progressBar">0%</div>
        </div>

        <div id="quizContent"></div>

        <div style="text-align: center; margin-top: 30px;">
            <button class="quiz-button" id="prevBtn" onclick="prevQuestion()" style="display:none;">‚Üê Previous</button>
            <button class="quiz-button" id="nextBtn" onclick="nextQuestion()" style="display:none;">Next ‚Üí</button>
            <button class="quiz-button" id="startBtn" onclick="startQuiz()">Start Quiz</button>
            <button class="quiz-button" id="submitBtn" onclick="submitQuiz()" style="display:none;">Submit Quiz</button>
            <button class="quiz-button" id="restartBtn" onclick="restartQuiz()" style="display:none;">Restart Quiz</button>
        </div>

        <div class="quiz-results" id="quizResults">
            <h2 style="text-align: center; color: #2C5282;">Quiz Results</h2>
            <div class="quiz-score" id="quizScore"></div>
            <div id="resultDetails"></div>
        </div>
        
        <div class="certificate" id="certificate">
            <h2>üèÜ Certificate of Completion üèÜ</h2>
            <p>This certifies that</p>
            <div class="certificate-name" id="certificateName">[Name]</div>
            <p>has successfully completed</p>
            <div style="font-size: 20px; margin: 15px 0;"><strong>CNC Manufacturing Fundamentals</strong></div>
            <div class="certificate-score" id="certificateScore"></div>
            <div style="margin-top: 30px; color: #666;">
                <p>Multiaxis Intelligence</p>
                <p id="certificateDate"></p>
            </div>
        </div>
        
        <div class="footer">¬©2025 Multiaxis Intelligence. All rights reserved | Generated with Quiz Generator - Multiaxis Intelligence</div>
    </div>

    <script>
        /* --- your quiz logic --- */
        let quizQuestions = [ /* same question list */ ];
        let currentQuestion = 0;
        let userAnswers = [];
        let quizStarted = false;

        // ...timer, showQuestion, selectAnswer, next/prev functions unchanged...

        function submitQuiz() {
            if (timerInterval) clearInterval(timerInterval);
            if (!QUIZ_CONFIG.showResults) { alert('Quiz submitted successfully!'); location.reload(); return; }
            
            let correct = 0;
            let resultHTML = '<div style="margin-top: 20px;">';
            
            quizQuestions.forEach((question, index) => {
                const userAnswer = userAnswers[index];
                const isCorrect = userAnswer === question.correct;
                if (isCorrect) correct++;
                resultHTML += `
                    <div class="result-item ${isCorrect ? 'correct' : 'incorrect'}">
                        <strong>Q${index + 1}: ${isCorrect ? '‚úì Correct' : '‚úó Incorrect'}</strong><br>
                        <p>${question.question}</p>
                        <p>Your answer: ${userAnswer !== null ? question.options[userAnswer] : 'Not answered'}</p>
                        ${!isCorrect ? `<p>Correct answer: ${question.options[question.correct]}</p>` : ''}
                        ${QUIZ_CONFIG.showExplanations && question.explanation ? `<p><em>${question.explanation}</em></p>` : ''}
                    </div>`;
            });
            
            resultHTML += '</div>';
            
            const percentage = Math.round((correct / quizQuestions.length) * 100);
            document.getElementById('quizScore').innerHTML = `${percentage}% (${correct}/${quizQuestions.length})`;
            document.getElementById('resultDetails').innerHTML = resultHTML;

            document.getElementById('quizContent').style.display = 'none';
            document.getElementById('quizResults').style.display = 'block';
            document.getElementById('submitBtn').style.display = 'none';
            document.getElementById('nextBtn').style.display = 'none';
            document.getElementById('prevBtn').style.display = 'none';
            document.getElementById('restartBtn').style.display = 'inline-block';
            document.getElementById('timerDisplay').style.display = 'none';
            document.getElementById('progressBar').style.width = '100%';
            document.getElementById('progressBar').textContent = '100%';

            // ‚¨áÔ∏è Send email with results
            const summary = quizQuestions.map((q, i) => {
                const ua = userAnswers[i] !== null ? q.options[userAnswers[i]] : 'Not answered';
                return `Q${i+1}: ${q.question}\nYour answer: ${ua}\nCorrect: ${q.options[q.correct]}\n`;
            }).join("\n");
            sendQuizResults(summary, percentage, correct, quizQuestions.length);
        }
    </script>
</body>
</html>
